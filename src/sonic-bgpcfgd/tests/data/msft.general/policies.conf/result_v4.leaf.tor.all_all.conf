!
! template: bgpd/templates/general/policies.conf.j2
!
! template: bgpd/templates/msft.general/v4.leaf.tor.all/policy.conf.j2
!
bgp community-list standard LEAK_COMMUNITY permit 8075:10400
bgp community-list standard UPSTREAM_PREFIX permit 8075:54000
bgp community-list expanded LEAK_PLUS_UPSTREAM permit .*8075:10400.*8075:54000.*
bgp community-list expanded LEAK_PLUS_UPSTREAM permit .*8075:54000.*8075:10400.*
bgp community-list standard drop_community permit no-export
bgp community-list standard SLB_PREFIX permit 8075:9300
!
bgp as-path access-list BBR_AS_PATH permit ^[0-9]+_65100
bgp as-path access-list SLB_ASN permit _65511$
bgp as-path access-list SLB_ASN permit _64523$
!
ip prefix-list DEFAULT_IPV4 permit 0.0.0.0/0
ip prefix-list IPV4_18_OR_LONGER permit 0.0.0.0/0 ge 18
!
route-map FROM_TIER0_V4_DEPLOYMENT_ID_3 permit 100
  match ip address prefix-list DEFAULT_IPV4
  match community UPSTREAM_PREFIX
  set local-preference 90
!
route-map FROM_TIER0_V4_DEPLOYMENT_ID_3 permit 200
  match community LEAK_PLUS_UPSTREAM
  set local-preference 90
!
route-map FROM_TIER0_V4_DEPLOYMENT_ID_3 permit 500
  match community LEAK_COMMUNITY
  match ip address prefix-list IPV4_18_OR_LONGER
  set comm-list LEAK_COMMUNITY delete
!
route-map FROM_TIER0_V4_DEPLOYMENT_ID_3 permit 600
  match ip address prefix-list IPV4_18_OR_LONGER
!
route-map FROM_TIER0_V4_DEPLOYMENT_ID_3 deny 10000
!
route-map TO_TIER0_V4 permit 100
  match ip address prefix-list DEFAULT_IPV4
  match community UPSTREAM_PREFIX
!
route-map TO_TIER0_V4 permit 200
  match community LEAK_PLUS_UPSTREAM
!
route-map TO_TIER0_V4 permit 300
  match community UPSTREAM_PREFIX
  set community no-export additive
!
route-map TO_TIER0_V4 permit 10000
!
! end of template: bgpd/templates/msft.general/v4.leaf.tor.all/policy.conf.j2
!
! end of template: bgpd/templates/general/policies.conf.j2
!
